<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>WorldTV - Canales en Vivo</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
<link href="https://vjs.zencdn.net/7.20.3/video-js.min.css" rel="stylesheet" />
<style>
  /* Reset y básicos */
  * {
    margin: 0; padding: 0; box-sizing: border-box;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  }
  body {
    background: linear-gradient(135deg, #0c0c0c 0%, #1a1a1a 100%);
    color: #fff;
    min-height: 100vh;
    overflow-x: hidden;
    overflow-y: auto;
  }
  #splash-screen {
    position: fixed; top: 0; left: 0;
    width: 100%; height: 100%;
    background-color: #000;
    display: flex; justify-content: center; align-items: center;
    z-index: 1000;
    transition: opacity 1.2s ease-out;
  }
  .logo {
    display: flex;
  }
  .logo span {
    font-size: 80px;
    font-weight: 900;
    opacity: 0;
    transform: translateY(30px);
    color: #e50914;
    text-shadow: 0 0 10px rgba(229,9,20,0.7);
  }
  #main-content {
    display: none;
    padding: 20px;
    max-width: 1400px;
    margin: 0 auto;
  }
  header {
    display: flex; justify-content: space-between; align-items: center;
    padding: 20px 0; margin-bottom: 30px;
    border-bottom: 1px solid #333;
  }
  header h1 {
    color: #e50914;
    font-size: 32px;
    text-shadow: 0 0 8px rgba(229,9,20,0.5);
  }
  .back-button {
    display: none;
    background: #e50914;
    color: #fff;
    border: none;
    padding: 10px 20px;
    border-radius: 5px;
    cursor: pointer;
    font-weight: bold;
    transition: background 0.3s;
  }
  .back-button:hover { background: #f40612; }
  .section-title {
    font-size: 28px;
    margin-bottom: 25px;
    color: #e5e5e5;
    padding-left: 15px;
    border-left: 5px solid #e50914;
  }
  
  /* Catálogo paises en forma rectangular y más pequeña */
  .countries-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
    gap: 20px;
    margin-bottom: 50px;
  }
  .country-card {
    position: relative;
    height: 280px;
    border-radius: 10px;
    overflow: hidden;
    cursor: pointer;
    transition: transform 0.4s ease, box-shadow 0.4s ease;
    box-shadow: 0 5px 15px rgba(0,0,0,0.5);
  }
  .country-card:hover {
    transform: scale(1.05);
    box-shadow: 0 8px 25px rgba(229,9,20,0.3);
  }
  .country-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }
  .country-name {
    position: absolute;
    bottom: 0; left: 0; right: 0;
    background: linear-gradient(to top, rgba(0,0,0,0.9), transparent);
    padding: 20px 15px 15px;
    font-size: 20px;
    font-weight: 600;
    text-align: center;
  }

  /* Canales y resto sin cambios */
  .channels-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(150px,1fr));
    gap: 20px;
    margin-bottom: 40px;
  }
  .channel-card {
    background: #181818;
    border-radius: 10px;
    overflow: hidden;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    cursor: pointer;
    box-shadow: 0 4px 8px rgba(0,0,0,0.4);
    position: relative;
    height: 180px;
  }
  .channel-card:hover {
    transform: scale(1.08);
    box-shadow: 0 8px 16px rgba(229,9,20,0.3);
  }
  .channel-image {
    width: 100%;
    height: 120px;
    object-fit: cover;
    background: linear-gradient(45deg, #2c2c2c, #1a1a1a);
    display: flex;
    justify-content: center;
    align-items: center;
    color: #aaa;
    font-size: 12px;
  }
  .channel-name {
    padding: 10px 5px;
    text-align: center;
    font-size: 12px;
    color: #e5e5e5;
    font-weight: 500;
    height: 60px;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  .fullscreen-player {
    display: none;
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: #000;
    z-index: 1000;
    flex-direction: column;
    overflow: hidden;
  }
  .player-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 15px 20px;
    background: rgba(0,0,0,0.8);
    border-bottom: 1px solid #333;
    color: #fff;
  }
  .player-title {
    font-size: 20px;
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 10px;
    color: #e50914;
  }
  .player-title i {
    font-size: 24px;
  }
  .player-controls {
    display: flex;
    align-items: center;
    gap: 15px;
  }
  .player-btn {
    background: rgba(255,255,255,0.1);
    border: none;
    color: white;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.2s ease;
  }
  .player-btn:hover {
    background: rgba(255,255,255,0.2);
    transform: scale(1.1);
  }
  .player-body {
    flex: 1;
    display: flex;
    justify-content: center;
    align-items: center;
    background: #000;
    position: relative;
  }
  .video-js {
    width: 100%!important;
    height: 100%!important;
  }
  #player-iframe {
    width: 100%;
    height: 100%;
    border: none;
    display: none;
  }
  .player-message {
    text-align: center;
    padding: 20px;
    max-width: 600px;
    color: #e50914;
  }
  .player-message h3 {
    margin-bottom: 15px;
    font-weight: bold;
  }
  .external-link {
    display: inline-block;
    background: #e50914;
    color: white;
    padding: 12px 25px;
    border-radius: 5px;
    text-decoration: none;
    font-weight: bold;
    transition: background 0.3s;
  }
  .external-link:hover {
    background: #f40612;
  }
  footer {
    text-align: center;
    padding: 30px 0;
    margin-top: 50px;
    border-top: 1px solid #333;
    color: #888;
    font-size: 14px;
  }

  /* Modal centrado para página web completa y reproductor en el centro */
  #modal-overlay {
    position: fixed;
    top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(0,0,0,0.85);
    display: none;
    justify-content: center;
    align-items: center;
    z-index: 1100;
    overflow: hidden;
  }
  #modal-content {
    background: #000;
    border-radius: 10px;
    width: 960px;
    max-width: 90%;
    height: 540px; /* 16:9 ratio */
    max-height: 90%;
    position: relative;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
  }
  #modal-close-btn {
    position: absolute;
    top: 10px; right: 10px;
    background: #e50914;
    border: none;
    color: white;
    padding: 8px 15px;
    font-size: 20px;
    cursor: pointer;
    border-radius: 5px;
    z-index: 10;
  }
  #modal-iframe {
    border: none;
    width: 100%;
    height: 100%;
    overflow: hidden;
    pointer-events: auto;
    -ms-overflow-style: none;
    scrollbar-width: none;
  }
  #modal-iframe::-webkit-scrollbar {
    display: none;
  }
</style>
</head>
<body>

<div id="search-container" aria-label="Buscar canales" role="search" style="margin: 20px auto 25px auto; display: flex; justify-content: center; position: relative; max-width: 320px; width: 90%;">
  <input 
    id="search-channels" 
    type="search" 
    placeholder="Buscar canales..." 
    autocomplete="off"
    style="
      width: 100%;
      padding: 10px 40px 10px 15px;
      border-radius: 20px;
      border: 2px solid #e50914;
      background-color: #111;
      color: #fff;
      font-size: 16px;
      transition: border-color 0.3s ease;
    "
  />
  <i 
    class="fa fa-search" 
    aria-hidden="true" 
    style="
      position: absolute;
      right: 15px;
      top: 50%;
      transform: translateY(-50%);
      color: #e50914;
      font-size: 18px;
      pointer-events: none;
    "
  ></i>
</div>





<div id="splash-screen">
  <div class="logo">
    <span>W</span><span>o</span><span>r</span><span>l</span><span>d</span><span>T</span><span>V</span>
  </div>
</div>

<div id="modal-overlay" role="dialog" aria-modal="true" aria-label="Ventana modal reproductor">
  <div id="modal-content">
    <button id="modal-close-btn" aria-label="Cerrar modal">&times;</button>
    <iframe id="modal-iframe" allowfullscreen sandbox="allow-scripts allow-same-origin allow-presentation"></iframe>
  </div>
</div>

<div class="fullscreen-player" id="fullscreen-player">
  <div class="player-header">
    <div class="player-title">
      <i class="fas fa-tv"></i>
      <span id="player-channel-name">Nombre del Canal</span>
    </div>
    <div class="player-controls">
      <button class="player-btn" id="fullscreen-btn" title="Pantalla completa"><i class="fas fa-expand"></i></button>
      <button class="player-btn" id="close-player-btn" title="Cerrar reproductor"><i class="fas fa-times"></i></button>
    </div>
  </div>
  <div class="player-body" id="player-body">
    <video id="video-player" class="video-js vjs-default-skin" controls preload="auto" style="display:none;"></video>
    <iframe id="player-iframe" allowfullscreen sandbox="allow-scripts allow-same-origin allow-presentation" style="display:none;"></iframe>
  </div>
</div>

<div id="main-content">
  <header>
    <h1><i class="fas fa-globe-americas"></i> WorldTV - Canales en Vivo</h1>
    <button class="back-button" id="back-button"><i class="fas fa-arrow-left"></i> Volver a Países</button>
  </header>

  <div id="countries-section">
    <h2 class="section-title">Selecciona un País</h2>
    <div class="countries-grid" id="countries-grid"></div>
  </div>

  <div id="channels-section">
    <h2 class="section-title" id="channels-title">Canales de </h2>
    <div class="channels-grid" id="channels-grid"></div>
  </div>

  <footer>
    <p>© 2023 WorldTV - Todos los derechos reservados</p>
  </footer>
</div>

<script src="https://vjs.zencdn.net/7.20.3/video.min.js"></script>
<script src="https://unpkg.com/videojs-http-streaming@2.14.2/dist/videojs-http-streaming.min.js"></script>
<script>
  const countriesData = [
    {
      id: "test",
      name: "HONDURAS",
      image: "https://images.unsplash.com/photo-1485738422979-f5c462d49f74?ixlib=rb-4.0.3&auto=format&fit=crop&w=1199&q=80",
      channels: [
        { name: "CANAL 5 EL LIDER", image: "https://via.placeholder.com/300x200/006A4D/FFFFFF?text=M3U8", stream: "https://mdstrm.com/live-stream-playlist/6287fdc9303e3008289ab711.m3u8", type: "m3u8" },
        { name: "HCH", image: "https://via.placeholder.com/300x200/C10B26/FFFFFF?text=Iframe", stream: "https://envivo.canal6.com.hn/memfs/5a536b3e-954a-4124-a17a-d94bbd0968a2.m3u8", type: "m3u8" },
        { name: "YouTube Live", image: "https://via.placeholder.com/300x200/0B5C9A/FFFFFF?text=YouTube", stream: "https://www.televicentro.com/envivo/d829deb7-e5bd-4688-aa79-3ecb75461d72", type: "iframe" },
        { name: "Dailymotion Live", image: "https://via.placeholder.com/300x200/0077B6/FFFFFF?text=Dailymotion", stream: "https://www.dailymotion.com/embed/video/x81za5c?autoplay=1", type: "iframe" }
      ]
    },
    {
      id: "mexico",
      name: "México",
      image: "https://images.unsplash.com/photo-1518639192441-8fce0a366e2e?ixlib=rb-4.0.3&auto=format&fit=crop&w=1198&q=80",
      channels: [
        { name: "Televisa", image: "https://via.placeholder.com/300x200/012B6D/FFFFFF?text=Televisa", stream: "https://www.youtube.com/embed/live_stream?channel=UCjzHeG1KWoonmf9d5KBvSiw", type: "iframe" },
        { name: "TV Azteca", image: "https://via.placeholder.com/300x200/EC1C24/FFFFFF?text=Azteca", stream: "https://www.youtube.com/embed/live_stream?channel=UC9pOtsS4gJt2jFx5fBaKJtQ", type: "iframe" }
      ]
    }
  ];

  let currentCountry = null;
  let isFullscreen = false;
  let player = null;

  function isStreamingUrl(url) {
    return url.match(/\.m3u8(\?.*)?$/) !== null
      || url.includes('youtube.com/embed')
      || url.includes('dailymotion.com/embed');
  }

  function isWebPageUrl(url) {
    return !isStreamingUrl(url);
  }

  document.addEventListener('DOMContentLoaded', () => {
    const logoLetters = document.querySelectorAll('.logo span');
    const splashScreen = document.getElementById('splash-screen');
    const mainContent = document.getElementById('main-content');
    logoLetters.forEach((letter, i) => {
      setTimeout(() => {
        letter.style.opacity = '1';
        letter.style.transform = 'translateY(0)';
        letter.style.transition = 'opacity 0.7s ease, transform 0.7s ease';
      }, 150 * i);
    });
    setTimeout(() => {
      splashScreen.style.opacity = '0';
      setTimeout(() => {
        splashScreen.style.display = 'none';
        mainContent.style.display = 'block';
        loadCountries();
        setupEventListeners();
      }, 1200);
    }, 2000);
  });

  function setupEventListeners() {
    document.getElementById('back-button').addEventListener('click', showCountriesSection);
    document.getElementById('fullscreen-btn').addEventListener('click', toggleFullscreen);
    document.getElementById('close-player-btn').addEventListener('click', closePlayer);
    document.getElementById('modal-close-btn').addEventListener('click', closeModal);
    document.addEventListener('keydown', e => {
      if (e.key === 'Escape') {
        if (isModalOpen()) closeModal();
        else if (isFullscreen) toggleFullscreen();
        else closePlayer();
      }
    });
  }

  function isModalOpen() {
    return document.getElementById('modal-overlay').style.display === 'flex';
  }

  function loadCountries() {
    const countriesGrid = document.getElementById('countries-grid');
    countriesGrid.innerHTML = '';
    countriesData.forEach(country => {
      const card = document.createElement('div');
      card.className = 'country-card';
      card.dataset.countryId = country.id;
      const img = document.createElement('img');
      img.className = 'country-image';
      img.src = country.image;
      img.alt = country.name;
      const nameDiv = document.createElement('div');
      nameDiv.className = 'country-name';
      nameDiv.textContent = country.name;
      card.appendChild(img);
      card.appendChild(nameDiv);
      card.addEventListener('click', () => showChannels(country));
      countriesGrid.appendChild(card);
    });
  }

  function showChannels(country) {
    currentCountry = country;
    document.getElementById('countries-section').style.display = 'none';
    document.getElementById('channels-section').style.display = 'block';
    document.getElementById('back-button').style.display = 'block';
    document.getElementById('channels-title').textContent = `Canales de ${country.name}`;
    const channelsGrid = document.getElementById('channels-grid');
    channelsGrid.innerHTML = '';
    country.channels.forEach(channel => {
      const card = document.createElement('div');
      card.className = 'channel-card';
      card.dataset.channelName = channel.name;
      const imgDiv = document.createElement('div');
      imgDiv.className = 'channel-image';
      if (channel.image) {
        imgDiv.style.backgroundImage = `url('${channel.image}')`;
        imgDiv.style.backgroundSize = 'cover';
        imgDiv.style.backgroundPosition = 'center';
      } else {
        imgDiv.textContent = channel.name;
      }
      const nameDiv = document.createElement('div');
      nameDiv.className = 'channel-name';
      nameDiv.textContent = channel.name;
      card.appendChild(imgDiv);
      card.appendChild(nameDiv);
      card.addEventListener('click', () => openPlayer(channel));
      channelsGrid.appendChild(card);
    });
    window.scrollTo({ top: 0, behavior: 'smooth' });
  }

  function openPlayer(channel) {
    const playerElement = document.getElementById('fullscreen-player');
    const videoPlayerEl = document.getElementById('video-player');
    const iframe = document.getElementById('player-iframe');
    const channelName = document.getElementById('player-channel-name');

    channelName.textContent = channel.name;
    playerElement.style.display = 'flex';
    clearPlayer();

    if (isWebPageUrl(channel.stream)) {
      openModal(channel.stream);
      closePlayer();
      return;
    }

    if (channel.type === 'm3u8') {
      iframe.style.display = 'none';
      videoPlayerEl.style.display = 'block';
      if (!player) {
        player = videojs('video-player', {
          controls: true,
          autoplay: true,
          fluid: true,
          html5: { vhs: { overrideNative: true } }
        });
      }
      player.src({ src: channel.stream, type: 'application/x-mpegURL' });
      player.play().catch(() => {
        openModal(channel.stream);
        closePlayer();
      });
    } else if (channel.type === 'iframe') {
      videoPlayerEl.style.display = 'none';
      iframe.style.display = 'block';
      iframe.src = channel.stream;
      iframe.onerror = () => {
        openModal(channel.stream);
        closePlayer();
      };
    } else {
      showErrorMessage(channel, 'Tipo de stream no reconocido.');
      videoPlayerEl.style.display = 'none';
      iframe.style.display = 'none';
    }
  }

  function clearPlayer() {
    if (player) {
      player.pause();
      player.src('');
    }
    const iframe = document.getElementById('player-iframe');
    iframe.src = '';
    const messageDiv = document.querySelector('.player-message');
    if (messageDiv) messageDiv.remove();
  }

  function showErrorMessage(channel, message) {
    clearPlayer();
    const playerBody = document.getElementById('player-body');
    const html = `
      <div class="player-message" role="alert">
        <h3>Contenido Protegido</h3>
        <p>${message}</p>
        <p>Puedes ver este canal haciendo clic en el siguiente enlace:</p>
        <a href="${channel.stream}" class="external-link" target="_blank" rel="noopener" tabindex="0">
          <i class="fas fa-external-link-alt"></i> Ver canal externamente
        </a>
      </div>
    `;
    playerBody.insertAdjacentHTML('beforeend', html);
  }

  function openModal(stream) {
    const modal = document.getElementById('modal-overlay');
    const modalIframe = document.getElementById('modal-iframe');
    modalIframe.src = stream;
    modal.style.display = 'flex';
    document.body.style.overflow = 'hidden';
  }

  function closeModal() {
    const modal = document.getElementById('modal-overlay');
    const modalIframe = document.getElementById('modal-iframe');
    modal.style.display = 'none';
    modalIframe.src = '';
    document.body.style.overflow = '';
  }

  function toggleFullscreen() {
    const playerElement = document.getElementById('fullscreen-player');
    const fullscreenBtn = document.getElementById('fullscreen-btn');
    if (!isFullscreen) {
      if (playerElement.requestFullscreen) playerElement.requestFullscreen();
      else if (playerElement.webkitRequestFullscreen) playerElement.webkitRequestFullscreen();
      else if (playerElement.msRequestFullscreen) playerElement.msRequestFullscreen();
      fullscreenBtn.innerHTML = '<i class="fas fa-compress"></i>';
      isFullscreen = true;
    } else {
      if (document.exitFullscreen) document.exitFullscreen();
      else if (document.webkitExitFullscreen) document.webkitExitFullscreen();
      else if (document.msExitFullscreen) document.msExitFullscreen();
      fullscreenBtn.innerHTML = '<i class="fas fa-expand"></i>';
      isFullscreen = false;
    }
  }

  function closePlayer() {
    if (isFullscreen) toggleFullscreen();
    clearPlayer();
    document.getElementById('fullscreen-player').style.display = 'none';
  }

  function showCountriesSection() {
    closePlayer();
    document.getElementById('channels-section').style.display = 'none';
    document.getElementById('countries-section').style.display = 'block';
    document.getElementById('back-button').style.display = 'none';
    window.scrollTo({ top: 0, behavior: 'smooth' });
  }
  
  
const searchInput = document.getElementById('search-channels');
const countriesSection = document.getElementById('countries-section');
const channelsSection = document.getElementById('channels-section');
const channelsGrid = document.getElementById('channels-grid');
const backButton = document.getElementById('back-button');
const channelsTitle = document.getElementById('channels-title');

searchInput.addEventListener('input', () => {
  const query = searchInput.value.toLowerCase().trim();

  if(!query) {
    // Mostrar países y ocultar canales cuando borramos búsqueda
    countriesSection.style.display = 'block';
    channelsSection.style.display = 'none';
    backButton.style.display = 'none';
    channelsGrid.innerHTML = '';
    channelsTitle.textContent = '';
    return;
  }

  // Buscar canales de todos los países
  const matches = [];
  countriesData.forEach(country => {
    country.channels.forEach(channel => {
      if(channel.name.toLowerCase().includes(query)) {
        matches.push(channel);
      }
    });
  });

  // Mostrar canales encontrados
  countriesSection.style.display = 'none';
  channelsSection.style.display = 'block';
  backButton.style.display = 'block';
  channelsTitle.textContent = `Canales encontrados: "${query}"`;
  channelsGrid.innerHTML = '';

  if(matches.length > 0){
    matches.forEach(channel => {
      const card = document.createElement('div');
      card.className = 'channel-card';
      card.dataset.channelName = channel.name.toLowerCase();
      const imgDiv = document.createElement('div');
      imgDiv.className = 'channel-image';
      if(channel.image){
        imgDiv.style.backgroundImage = `url('${channel.image}')`;
        imgDiv.style.backgroundSize = 'cover';
        imgDiv.style.backgroundPosition = 'center';
      } else {
        imgDiv.textContent = channel.name;
      }
      const nameDiv = document.createElement('div');
      nameDiv.className = 'channel-name';
      nameDiv.textContent = channel.name;
      card.appendChild(imgDiv);
      card.appendChild(nameDiv);
      card.addEventListener('click', () => openPlayer(channel));
      channelsGrid.appendChild(card);
    });
  } else {
    channelsGrid.innerHTML = `<p style="color:#e50914; padding:20px; text-align:center;">No se encontraron canales para "${query}".</p>`;
  }
});

  
  document.addEventListener('keydown', function(event) {
  // Códigos tecla back frecuentes en remotes TV y navegadores
  const backKeys = ['Backspace', 'Escape']; // para teclas nombradas
  const backKeyCodes = [8, 27, 10009]; // 10009 es el código back en Tizen (Samsung TV)

  if (backKeys.includes(event.key) || backKeyCodes.includes(event.keyCode)) {
    event.preventDefault();

    // Solo interferir si el botón volver está visible (usuario no está en pantalla países)
    const backVisible = backButton.style.display === 'block' || backButton.style.display === '';
    if (backVisible) {
      showCountriesSection();
    }
  }
});

  
</script>

</body>
</html>
